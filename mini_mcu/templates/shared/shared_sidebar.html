{% load static %}

<div class="h-full flex flex-col">
    <!-- Profile Section -->
    <div class="p-6 flex flex-col items-center border-b border-primary-dark/30">
        {% if avatar_upload_url %}
            {% if avatar_url %}
                <a href="#" class="block w-20 h-20 rounded-full overflow-hidden mb-4 ring-2 ring-white/50" title="Ubah foto profil" onclick="document.getElementById('avatarInput').click(); return false;">
                    <img src="{{ avatar_url }}" alt="Avatar" class="w-full h-full object-cover"/>
                </a>
            {% else %}
                <div class="w-20 h-20 rounded-full bg-white/20 mb-4 flex items-center justify-center cursor-pointer" title="Unggah foto profil" onclick="document.getElementById('avatarInput').click();">
                    <i class="fas fa-user text-4xl text-white/70"></i>
                </div>
            {% endif %}
        {% else %}
            {% if avatar_url %}
                <div class="w-20 h-20 rounded-full overflow-hidden mb-4 ring-2 ring-white/50">
                    <img src="{{ avatar_url }}" alt="Avatar" class="w-full h-full object-cover"/>
                </div>
            {% else %}
                <div class="w-20 h-20 rounded-full bg-white/20 mb-4 flex items-center justify-center">
                    <i class="fas fa-user text-4xl text-white/70"></i>
                </div>
            {% endif %}
        {% endif %}
        <p class="text-white font-medium">
            {% with display_username=request.session.username|default:request.user.username %}
                {% if greet_username %}
                    Hello, {{ display_username }}
                {% else %}
                    {% if greeting %}{{ greeting }}{% else %}Hello{% endif %}{% if role_title %} {{ role_title }}{% endif %}, {{ display_username }}
                {% endif %}
            {% endwith %}
        </p>
        {% if avatar_upload_url %}
            <form id="avatarForm" action="{{ avatar_upload_url }}" method="post" enctype="multipart/form-data" class="mt-3">
                {% csrf_token %}
                <input id="avatarInput" name="avatar" type="file" accept="image/png,image/jpeg,image/webp,image/gif" class="hidden" onchange="document.getElementById('avatarForm').submit();" />
                <button type="button" class="text-xs text-white/80 underline" onclick="document.getElementById('avatarInput').click();">Ganti foto</button>
            </form>
        {% endif %}
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 overflow-y-auto px-6 py-8">
        <ul class="flex flex-col gap-3">
            {% for item in menu_items %}
            <li>
                <a href="{{ item.url }}" 
                   class="flex items-center gap-4 py-3 px-4 rounded-lg transition-all duration-200
                          {% if active_menu == item.key %}
                          bg-white/20 shadow-lg border-l-4 border-white font-semibold
                          {% else %}
                          hover:bg-white/10
                          {% endif %}">
                    <i class="fas fa-{{ item.icon }} w-6 h-6 text-white"></i>
                    <span class="text-white">{{ item.name }}</span>
                </a>
            </li>
            {% endfor %}
        </ul>
    </nav>

    <!-- Logout Button -->
    <div class="p-6 mt-auto border-t border-primary-dark/30">
        <a href="{% url 'accounts:logout' %}" 
           class="flex items-center justify-center gap-3 w-full bg-red-600 hover:bg-red-700 text-white py-3 px-4 rounded-lg transition-all duration-200">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
        </a>
    </div>
</div>
{% load static %}
